const state={allItems:[],currentPage:1,itemsPerPage:12,selectedTypes:[],selectedStatus:"all",sortPrizeOrder:"asc",sortDateOrder:"asc"};let config={};const loadConfig=async()=>{try{let e=await fetch("./configs/ttConfig.json");config=await e.json(),state.itemsPerPage=config.itemsPerPage}catch(t){console.error("Failed to load config:",t)}},showLoader=()=>{document.getElementById("loader").style.display="block"},hideLoader=()=>{document.getElementById("loader").style.display="none"},fetchItems=async()=>{if(showLoader(),config.useGoogleSheets)try{let e=await fetch(config.GoogleSheetsURL),t=await e.text(),a=csvToJson(t);state.allItems=a,hideLoader()}catch(s){console.error("Error fetching or converting CSV:",s),hideLoader()}else try{let r=await fetch(config.localJsonPath),l=await r.json();state.allItems=l,hideLoader()}catch(o){console.error("Error fetching local JSON:",o),hideLoader()}},csvToJson=e=>{let t=e.split("\n").filter(e=>e.trim()),a=t[0].split(",").map(e=>e.trim());return t.slice(1).map(e=>{let t=[],s,r=/(?:^|,)(?:"([^"]*)"|([^",]*))/g;for(;null!==(s=r.exec(e));){let l=void 0!==s[1]?s[1]:s[2];t.push(l.trim())}let o={};return a.forEach((e,a)=>{o[e]=void 0!==t[a]?t[a]:""}),o})},filterItems=()=>{let{allItems:e,selectedTypes:t,selectedStatus:a}=state;return e.filter(e=>{let s=document.getElementById("searchInput").value.toLowerCase(),r=["title","location","description","type"].some(t=>e[t]&&e[t].toLowerCase().includes(s)),l=0===t.length||t.includes(e.type),o="all"===a||e.status===a;return r&&l&&o})},updateDisplay=()=>{let e=document.getElementById("item_card_container");e.innerHTML=filterItems().map(e=>generateItemCardHTML(e)).join(""),toggleResetButton(),AOS.init({once:!1})},toggleSortByDate=()=>{state.sortDateOrder="asc"===state.sortDateOrder?"desc":"asc",console.log("Toggled sort order to:",state.sortDateOrder),sortItemsByDate(state.sortDateOrder)},sortItemsByDate=e=>{console.log("Sorting by date in order:",e),state.allItems.sort((t,a)=>{let s=new Date(t.date),r=new Date(a.date);return"asc"===e?s-r:r-s}),updateDisplay()},toggleSortByPrize=()=>{state.sortPrizeOrder="asc"===state.sortPrizeOrder?"desc":"asc",document.getElementById("sortIcon").classList.toggle("ti-sort-ascending","asc"===state.sortPrizeOrder),document.getElementById("sortIcon").classList.toggle("ti-sort-descending","desc"===state.sortPrizeOrder),sortItemsByPrize(state.sortPrizeOrder)},sortItemsByPrize=e=>{state.allItems.sort((t,a)=>{let s=parseInt(t.prize.replace(/[\$,]/g,"")),r=parseInt(a.prize.replace(/[\$,]/g,""));return"asc"===e?s-r:r-s}),updateDisplay()},generateItemCardHTML=e=>{let t=t=>e[t]||"";return`
